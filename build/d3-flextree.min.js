!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function n(n){var e=0,r=n.children,i=r&&r.length;if(i)for(;--i>=0;)e+=r[i].value;else e=1;n.value=e}function e(){return this.eachAfter(n)}function r(n){var e,r,i,t,l=this,h=[l];do{for(e=h.reverse(),h=[];l=e.pop();)if(n(l),r=l.children)for(i=0,t=r.length;i<t;++i)h.push(r[i])}while(h.length);return this}function i(n){for(var e,r,i=this,t=[i];i=t.pop();)if(n(i),e=i.children)for(r=e.length-1;r>=0;--r)t.push(e[r]);return this}function t(n){for(var e,r,i,t=this,l=[t],h=[];t=l.pop();)if(h.push(t),e=t.children)for(r=0,i=e.length;r<i;++r)l.push(e[r]);for(;t=h.pop();)n(t);return this}function l(n){return this.eachAfter(function(e){for(var r=+n(e.data)||0,i=e.children,t=i&&i.length;--t>=0;)r+=i[t].value;e.value=r})}function h(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function u(n){for(var e=this,r=o(e,n),i=[e];e!==r;)e=e.parent,i.push(e);for(var t=i.length;n!==r;)i.splice(t,0,n),n=n.parent;return i}function o(n,e){if(n===e)return n;var r=n.ancestors(),i=e.ancestors(),t=null;for(n=r.pop(),e=i.pop();n===e;)t=n,n=r.pop(),e=i.pop();return t}function c(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function d(){var n=[];return this.each(function(e){n.push(e)}),n}function a(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function f(){var n=this,e=[];return n.each(function(r){r!==n&&e.push({source:r.parent,target:r})}),e}function s(n,e){var r,i,t,l,h,u=new y(n),o=+n.value&&(u.value=n.value),c=[u];for(null==e&&(e=p);r=c.pop();)if(o&&(r.value=+r.data.value),(t=e(r.data))&&(h=t.length))for(r.children=new Array(h),l=h-1;l>=0;--l)c.push(i=r.children[l]=new y(t[l])),i.parent=r,i.depth=r.depth+1;return u.eachBefore(x)}function v(){return s(this).eachBefore(m)}function p(n){return n.children}function m(n){n.data=n.data.data}function x(n){var e=0;do{n.height=e}while((n=n.parent)&&n.height<++e)}function y(n){this.data=n,this.depth=this.height=0,this.parent=null}function g(n,e,r,i,t){for(var l,h=n.children,u=-1,o=h.length,c=n.value&&(i-e)/n.value;++u<o;)l=h[u],l.y0=r,l.y1=t,l.x0=e,l.x1=e+=l.value*c}function C(n,e,r,i,t){for(var l,h=n.children,u=-1,o=h.length,c=n.value&&(t-r)/n.value;++u<o;)l=h[u],l.x0=e,l.x1=i,l.y0=r,l.y1=r+=l.value*c}function z(n,e,r,i,t,l){for(var h,u,o,c,d,a,f,s,v,p,m,x=[],y=e.children,z=0,S=0,w=y.length,A=e.value;z<w;){o=t-r,c=l-i;do{d=y[S++].value}while(!d&&S<w);for(a=f=d,p=Math.max(c/o,o/c)/(A*n),m=d*d*p,v=Math.max(f/m,m/a);S<w;++S){if(d+=u=y[S].value,u<a&&(a=u),u>f&&(f=u),m=d*d*p,(s=Math.max(f/m,m/a))>v){d-=u;break}v=s}x.push(h={value:d,dice:o<c,children:y.slice(z,S)}),h.dice?g(h,r,i,t,A?i+=c*d/A:l):C(h,r,i,A?r+=o*d/A:t,l),A-=d,z=S}return x}function S(){function n(n){var e=r(n);return b=e,i(e,0),l(e),m(e,0),C(e),n}function e(n){if(this.t=n,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.msel=0,this.mser=0,n.x=0,n.y=0,B)this.xSize=1,this.ySize=1;else if(Array.isArray(M))this.xSize=M[0],this.ySize=M[1];else{var e=M(n);this.xSize=e[0],this.ySize=e[1]}this.children=[],this.numChildren=0}function r(n){for(var i=new e(n),t=i.children,l=n.children?n.children.length:0,h=0;h<l;++h)t.push(r(n.children[h]));return i.numChildren=l,i}function i(n,e){n.t.y=e,t(n)}function t(n){var e,r=n.t.y+n.ySize;for(e=0;e<n.children.length;++e){n.children[e].t.y=r,t(n.children[e])}}function l(n){if(0===n.numChildren)return void h(n);l(n.children[0]);for(var e=g(a(n.children[0].el),0,null),r=1;r<n.numChildren;++r){l(n.children[r]);var i=a(n.children[r].er);u(n,r,e),e=g(i,r,e)}p(n),h(n)}function h(n){0===n.numChildren?(n.el=n,n.er=n,n.msel=n.mser=0):(n.el=n.children[0].el,n.msel=n.children[0].msel,n.er=n.children[n.numChildren-1].er,n.mser=n.children[n.numChildren-1].mser)}function u(n,e,r){for(var i=n.children[e-1],t=i.mod,l=n.children[e],h=l.mod;void 0!==i&&void 0!==l;){a(i)>r.lowY&&(r=r.nxt);var u=t+i.prelim-(h+l.prelim);null!==S?u+=S(i.t,l.t)*b.xSize:null!==A&&(u+=i.xSize/2+l.xSize/2+A(i.t,l.t)),u>0?(h+=u,o(n,e,r.index,u)):1===e&&0===h&&0===i.numChildren&&l.numChildren>1&&u<0&&(h+=u,o(n,e,r.index,u));var s=a(i),p=a(l);s<=p&&void 0!==(i=d(i))&&(t+=i.mod),s>=p&&void 0!==(l=c(l))&&(h+=l.mod)}void 0===i&&void 0!==l?f(n,e,l,h):void 0!==i&&void 0===l&&v(n,e,i,t)}function o(n,e,r,i){n.children[e].mod+=i,n.children[e].msel+=i,n.children[e].mser+=i,x(n,e,r,i)}function c(n){return 0===n.numChildren?n.tl:n.children[0]}function d(n){return 0===n.numChildren?n.tr:n.children[n.numChildren-1]}function a(n){return n.t.y+n.ySize}function f(n,e,r,i){var t=n.children[0].el;t.tl=r;var l=i-r.mod-n.children[0].msel;t.mod+=l,t.prelim-=l,n.children[0].el=n.children[e].el,n.children[0].msel=n.children[e].msel}function v(n,e,r,i){var t=n.children[e].er;t.tr=r;var l=i-r.mod-n.children[e].mser;t.mod+=l,t.prelim-=l,n.children[e].er=n.children[e-1].er,n.children[e].mser=n.children[e-1].mser}function p(n){n.prelim=(n.children[0].prelim+n.children[0].mod-n.children[0].xSize/2+n.children[n.numChildren-1].mod+n.children[n.numChildren-1].prelim+n.children[n.numChildren-1].xSize/2)/2}function m(n,e){e+=n.mod,n.t.x=n.prelim+e,y(n);for(var r=0;r<n.numChildren;r++)m(n.children[r],e)}function x(n,e,r,i){if(r!==e-1){var t=e-r;n.children[r+1].shift+=i/t,n.children[e].shift-=i/t,n.children[e].change-=i-i/t}}function y(n){for(var e=0,r=0,i=0;i<n.numChildren;i++)e+=n.children[i].shift,r+=e+n.children[i].change,n.children[i].mod+=r}function g(n,e,r){for(;null!==r&&n>=r.lowY;)r=r.nxt;return{lowY:n,index:e,nxt:r}}function C(n){if(null!==B){for(var e,r=n,i=n,t=n,l=[n];e=l.pop();){var h=e.t;h.x<r.t.x&&(r=e),h.x>i.t.x&&(i=e),h.depth>t.t.depth&&(t=e),e.children&&(l=l.concat(e.children))}var u=void 0===S?.5:S(r.t,i.t)/2,o=u-r.t.x,c=B[0]/(i.t.x+u+o),d=B[1]/(t.t.depth>0?t.t.depth:1);for(l=[n];e=l.pop();){var h=e.t;h.x=(h.x+o)*c,h.y=h.depth*d,e.children&&(l=l.concat(e.children))}}else{z(n,-n.t.x)}}function z(n,e){n.t.x+=e;for(var r=0;r<n.numChildren;++r)z(n.children[r],e)}var S=w,A=null,B=[1,1],M=null,b=null;return e.prototype=Object.create(s.prototype),n.separation=function(e){return arguments.length?(S=e,A=null,n):S},n.spacing=function(e){return arguments.length?(A=e,S=null,n):A},n.size=function(e){return arguments.length?(B=e,M=null,n):B},n.nodeSize=function(e){return arguments.length?(M=e,B=null,n):M},n}function w(n,e){return n.parent===e.parent?1:2}y.prototype=s.prototype={constructor:y,count:e,each:r,eachAfter:t,eachBefore:i,sum:l,sort:h,path:u,ancestors:c,descendants:d,leaves:a,links:f,copy:v};var A=(1+Math.sqrt(5))/2;!function n(e){function r(n,r,i,t,l){z(e,n,r,i,t,l)}return r.ratio=function(e){return n((e=+e)>1?e:1)},r}(A),function n(e){function r(n,r,i,t,l){if((h=n._squarify)&&h.ratio===e)for(var h,u,o,c,d,a=-1,f=h.length,s=n.value;++a<f;){for(u=h[a],o=u.children,c=u.value=0,d=o.length;c<d;++c)u.value+=o[c].value;u.dice?g(u,r,i,t,i+=(l-i)*u.value/s):C(u,r,i,r+=(t-r)*u.value/s,l),s-=u.value}else n._squarify=h=z(e,n,r,i,t,l),h.ratio=e}return r.ratio=function(e){return n((e=+e)>1?e:1)},r}(A),module.exports=S});