!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.d3=e.d3||{})}(this,function(e){"use strict";function n(e){var n=0,r=e.children,t=r&&r.length;if(t)for(;--t>=0;)n+=r[t].value;else n=1;e.value=n}function r(){return this.eachAfter(n)}function t(e){var n,r,t,i,l=this,h=[l];do{for(n=h.reverse(),h=[];l=n.pop();)if(e(l),r=l.children)for(t=0,i=r.length;t<i;++t)h.push(r[t])}while(h.length);return this}function i(e){for(var n,r,t=this,i=[t];t=i.pop();)if(e(t),n=t.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this}function l(e){for(var n,r,t,i=this,l=[i],h=[];i=l.pop();)if(h.push(i),n=i.children)for(r=0,t=n.length;r<t;++r)l.push(n[r]);for(;i=h.pop();)e(i);return this}function h(e){return this.eachAfter(function(n){for(var r=+e(n.data)||0,t=n.children,i=t&&t.length;--i>=0;)r+=t[i].value;n.value=r})}function u(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function o(e){for(var n=this,r=c(n,e),t=[n];n!==r;)n=n.parent,t.push(n);for(var i=t.length;e!==r;)t.splice(i,0,e),e=e.parent;return t}function c(e,n){if(e===n)return e;var r=e.ancestors(),t=n.ancestors(),i=null;for(e=r.pop(),n=t.pop();e===n;)i=e,e=r.pop(),n=t.pop();return i}function d(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function a(){var e=[];return this.each(function(n){e.push(n)}),e}function f(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function s(){var e=this,n=[];return e.each(function(r){r!==e&&n.push({source:r.parent,target:r})}),n}function p(e,n){var r,t,i,l,h,u=new g(e),o=+e.value&&(u.value=e.value),c=[u];for(null==n&&(n=m);r=c.pop();)if(o&&(r.value=+r.data.value),(i=n(r.data))&&(h=i.length))for(r.children=new Array(h),l=h-1;l>=0;--l)c.push(t=r.children[l]=new g(i[l])),t.parent=r,t.depth=r.depth+1;return u.eachBefore(y)}function v(){return p(this).eachBefore(x)}function m(e){return e.children}function x(e){e.data=e.data.data}function y(e){var n=0;do{e.height=n}while((e=e.parent)&&e.height<++n)}function g(e){this.data=e,this.depth=this.height=0,this.parent=null}function C(e,n,r,t,i){for(var l,h=e.children,u=-1,o=h.length,c=e.value&&(t-n)/e.value;++u<o;)l=h[u],l.y0=r,l.y1=i,l.x0=n,l.x1=n+=l.value*c}function z(e,n,r,t,i){for(var l,h=e.children,u=-1,o=h.length,c=e.value&&(i-r)/e.value;++u<o;)l=h[u],l.x0=n,l.x1=t,l.y0=r,l.y1=r+=l.value*c}function S(e,n,r,t,i,l){for(var h,u,o,c,d,a,f,s,p,v,m,x=[],y=n.children,g=0,S=0,w=y.length,A=n.value;g<w;){o=i-r,c=l-t;do{d=y[S++].value}while(!d&&S<w);for(a=f=d,v=Math.max(c/o,o/c)/(A*e),m=d*d*v,p=Math.max(f/m,m/a);S<w;++S){if(d+=u=y[S].value,u<a&&(a=u),u>f&&(f=u),m=d*d*v,(s=Math.max(f/m,m/a))>p){d-=u;break}p=s}x.push(h={value:d,dice:o<c,children:y.slice(g,S)}),h.dice?C(h,r,t,i,A?t+=c*d/A:l):z(h,r,t,A?r+=o*d/A:i,l),A-=d,g=S}return x}function w(){function e(e){if(this.t=e,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.msel=0,this.mser=0,e.x=0,e.y=0,B)this.xSize=1,this.ySize=1;else if(Array.isArray(M))this.xSize=M[0],this.ySize=M[1];else{var n=M(e);this.xSize=n[0],this.ySize=n[1]}this.children=[],this.numChildren=0}function n(e,n,r,t){e.children[n].mod+=t,e.children[n].msel+=t,e.children[n].mser+=t,c(e,n,r,t)}function r(e){return 0===e.numChildren?e.tl:e.children[0]}function t(e){return 0===e.numChildren?e.tr:e.children[e.numChildren-1]}function i(e){return e.t.y+e.ySize}function l(e,n,r,t){var i=e.children[0].el;i.tl=r;var l=t-r.mod-e.children[0].msel;i.mod+=l,i.prelim-=l,e.children[0].el=e.children[n].el,e.children[0].msel=e.children[n].msel}function h(e,n,r,t){var i=e.children[n].er;i.tr=r;var l=t-r.mod-e.children[n].mser;i.mod+=l,i.prelim-=l,e.children[n].er=e.children[n-1].er,e.children[n].mser=e.children[n-1].mser}function u(e){e.prelim=(e.children[0].prelim+e.children[0].mod-e.children[0].xSize/2+e.children[e.numChildren-1].mod+e.children[e.numChildren-1].prelim+e.children[e.numChildren-1].xSize/2)/2}function o(e,n){n+=e.mod,e.t.x=e.prelim+n,d(e);for(var r=0;r<e.numChildren;r++)o(e.children[r],n)}function c(e,n,r,t){if(r!==n-1){var i=n-r;e.children[r+1].shift+=t/i,e.children[n].shift-=t/i,e.children[n].change-=t-t/i}}function d(e){for(var n=0,r=0,t=0;t<e.numChildren;t++)n+=e.children[t].shift,r+=n+e.children[t].change,e.children[t].mod+=r}function a(e,n,r){for(;null!==r&&e>=r.lowY;)r=r.nxt;return{lowY:e,index:n,nxt:r}}function f(e,n){e.t.y=n,e.t.depth=0,s(e)}function s(e){var n,r=e.t.y+e.ySize,t=e.t.depth+1;for(n=0;n<e.children.length;++n){var i=e.children[n];i.t.y=r,i.t.depth=t,s(e.children[n])}}function v(e){if(0===e.numChildren)return void m(e);v(e.children[0]);for(var n=a(i(e.children[0].el),0,null),r=1;r<e.numChildren;++r){v(e.children[r]);var t=i(e.children[r].er);x(e,r,n),n=a(t,r,n)}u(e),m(e)}function m(e){0===e.numChildren?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.children[0].el,e.msel=e.children[0].msel,e.er=e.children[e.numChildren-1].er,e.mser=e.children[e.numChildren-1].mser)}function x(e,u,o){for(var c=e.children[u-1],d=c.mod,a=e.children[u],f=a.mod;void 0!==c&&void 0!==a;){i(c)>o.lowY&&(o=o.nxt);var s=d+c.prelim-(f+a.prelim);null!==S?s+=S(c.t,a.t)*j.xSize:null!==A&&(s+=c.xSize/2+a.xSize/2+A(c.t,a.t)),s>0?(f+=s,n(e,u,o.index,s)):1===u&&0===f&&0===c.numChildren&&a.numChildren>1&&s<0&&(f+=s,n(e,u,o.index,s));var p=i(c),v=i(a);p<=v&&void 0!==(c=t(c))&&(d+=c.mod),p>=v&&void 0!==(a=r(a))&&(f+=a.mod)}void 0===c&&void 0!==a?l(e,u,a,f):void 0!==c&&void 0===a&&h(e,u,c,d)}function y(n){for(var r=new e(n),t=r.children,i=n.children?n.children.length:0,l=0;l<i;++l)t.push(y(n.children[l]));return r.numChildren=i,r}function g(e){if(null!=B){for(var n,r=e,t=e,i=e,l=[e];n=l.pop();){var h=n.t;h.x<r.t.x&&(r=n),h.x>t.t.x&&(t=n),h.depth>i.t.depth&&(i=n),n.children&&(l=l.concat(n.children))}var u=null==S?.5:S(r.t,t.t)/2,o=u-r.t.x,c=B[0]/(t.t.x+u+o),d=B[1]/(i.t.depth>0?i.t.depth:1);for(l=[e];n=l.pop();){var h=n.t;h.x=(h.x+o)*c,h.y=h.depth*d,b&&(h.x_size*=c,h.y_size*=d),n.children&&(l=l.concat(n.children))}}else{C(e,-e.t.x)}}function C(e,n){e.t.x+=n;for(var r=0;r<e.numChildren;++r)C(e.children[r],n)}function z(e){w.root=e;var n=y(e);return j=n,f(n,0),v(n),o(n,0),g(n),e}var S=_,A=function(e,n){return 0},B=[1,1],M=null,b=!1,j=null;return e.prototype=Object.create(p.prototype),z.separation=function(e){return arguments.length?(S=e,A=null,z):S},z.spacing=function(e){return arguments.length?(A=e,S=null,z):A},z.size=function(e){return arguments.length?(B=e,M=null,z):B},z.nodeSize=function(e){return arguments.length?(M=e,B=null,z):M},z}g.prototype=p.prototype={constructor:g,count:r,each:t,eachAfter:l,eachBefore:i,sum:h,sort:u,path:o,ancestors:d,descendants:a,leaves:f,links:s,copy:v};var A=(1+Math.sqrt(5))/2;!function e(n){function r(e,r,t,i,l){S(n,e,r,t,i,l)}return r.ratio=function(n){return e((n=+n)>1?n:1)},r}(A),function e(n){function r(e,r,t,i,l){if((h=e._squarify)&&h.ratio===n)for(var h,u,o,c,d,a=-1,f=h.length,s=e.value;++a<f;){for(u=h[a],o=u.children,c=u.value=0,d=o.length;c<d;++c)u.value+=o[c].value;u.dice?C(u,r,t,i,t+=(l-t)*u.value/s):z(u,r,t,r+=(i-r)*u.value/s,l),s-=u.value}else e._squarify=h=S(n,e,r,t,i,l),h.ratio=n}return r.ratio=function(n){return e((n=+n)>1?n:1)},r}(A);var _=function(e,n){return e.parent===n.parent?1:2};w.hierarchy=p,e.flextree=w,Object.defineProperty(e,"__esModule",{value:!0})});